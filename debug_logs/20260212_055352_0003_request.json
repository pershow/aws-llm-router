{"model":"us.anthropic.claude-sonnet-4-5-20250929-v1:0","messages":[{"role":"user","content":[{"type":"text","text":"<user_info>\nOS Version: win32 10.0.26200\n\nShell: powershell\n\nWorkspace Paths:\n- D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router\n- D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\pllm\n\nIs directory a git repo: Yes, at:\n- D:/360MoveData/Users/Administrator/Desktop/AI-workspace/salessavvy/aws-cursor-router\n- D:/360MoveData/Users/Administrator/Desktop/AI-workspace/salessavvy/pllm\n\nToday's date: Thursday Feb 12, 2026\n\nTerminals folder: C:\\Users\\Administrator\\.cursor\\projects\\d-360MoveData-Users-Administrator-Desktop-AI-workspace-salessavvy-aws-cursor-router/terminals\n</user_info>\n\n<git_status>\nThis is the git status at the start of the conversation. Note that this status is a snapshot in time, and will not update during the conversation.\n\n\nGit repo: D:/360MoveData/Users/Administrator/Desktop/AI-workspace/salessavvy/aws-cursor-router\n\n## main...origin/main\n\n\nGit repo: D:/360MoveData/Users/Administrator/Desktop/AI-workspace/salessavvy/pllm\n\n## main...origin/main\n M cmd/server/main.go\n M config.docker.yaml\n M config.yaml\n M docker-compose.yml\n M go.mod\n M go.sum\n M internal/api/handlers/admin/keys.go\n M internal/api/handlers/dashboard.go\n M internal/api/router/router.go\n M internal/core/config/config.go\n M internal/core/config/model_pricing.go\n M internal/core/database/connection.go\n M internal/core/models/team.go\n M internal/services/data/cache/pricing_cache.go\n M internal/services/llm/models/routing/strategy.go\n M internal/services/llm/providers/bedrock.go\n M internal/services/monitoring/metrics/metrics_collector.go\n M web/index.html\n M web/src/components/AppNavbar.tsx\n M web/src/components/app-sidebar.tsx\n M web/src/components/keys/columns.tsx\n M web/src/main.tsx\n M web/src/pages/Callback.tsx\n M web/src/pages/DatabaseRequired.tsx\n M web/src/pages/Keys.tsx\n M web/src/pages/Login.tsx\n M web/src/pages/SilentRenew.tsx\n M web/src/pages/Unauthorized.tsx\n?? internal/api/docs/config.mjs\n?? internal/api/docs/theme/\n?? internal/services/llm/providers/bedrock_test.go\n?? web/src/lib/zh-cn.ts\n</git_status>\n\n<rules>\nThe rules section has a number of possible rules/memories/context that you should consider. In each subsection, we provide instructions about what information the subsection contains and how you should consider/follow the contents of the subsection.\n\n\n<user_rules description=\"These are rules set by the user that you should follow if appropriate.\">\n<user_rule>Always respond in Chinese-simplified</user_rule>\n</user_rules>\n</rules>\n\n<agent_skills>\nWhen users ask you to perform tasks, check if any of the available skills below can help complete the task more effectively. Skills provide specialized capabilities and domain knowledge. To use a skill, read the skill file at the provided absolute path using the Read tool, then follow the instructions within. When a skill is relevant, read and follow it IMMEDIATELY as your first action. NEVER just announce or mention a skill without actually reading and following it. Only use skills listed below.\n\n\n<available_skills description=\"Skills the agent can use. Use the Read tool with the provided absolute path to fetch full contents.\">\n<agent_skill fullPath=\"C:\\Users\\Administrator\\.codex\\skills\\.system\\skill-creator\\SKILL.md\">Guide for creating effective skills. This skill should be used when users want to create a new skill (or update an existing skill) that extends Codex's capabilities with specialized knowledge, workflows, or tool integrations.</agent_skill>\n\n<agent_skill fullPath=\"C:\\Users\\Administrator\\.codex\\skills\\.system\\skill-installer\\SKILL.md\">Install Codex skills into $CODEX_HOME/skills from a curated list or a GitHub repo path. Use when a user asks to list installable skills, install a curated skill, or install a skill from another repo (including private repos).</agent_skill>\n\n<agent_skill fullPath=\"C:\\Users\\Administrator\\.cursor\\skills-cursor\\create-rule\\SKILL.md\">Create Cursor rules for persistent AI guidance. Use when the user wants to create a rule, add coding standards, set up project conventions, configure file-specific patterns, create RULE.md files, or asks about .cursor/rules/ or AGENTS.md.</agent_skill>\n\n<agent_skill fullPath=\"C:\\Users\\Administrator\\.cursor\\skills-cursor\\create-skill\\SKILL.md\">Guides users through creating effective Agent Skills for Cursor. Use when the user wants to create, write, or author a new skill, or asks about skill structure, best practices, or SKILL.md format.</agent_skill>\n\n<agent_skill fullPath=\"C:\\Users\\Administrator\\.cursor\\skills-cursor\\update-cursor-settings\\SKILL.md\">Modify Cursor/VSCode user settings in settings.json. Use when the user wants to change editor settings, preferences, configuration, themes, font size, tab size, format on save, auto save, keybindings, or any settings.json values.</agent_skill>\n\n<agent_skill fullPath=\"c:\\Users\\Administrator\\.codex\\skills\\.system\\skill-creator\\SKILL.md\">Guide for creating effective skills. This skill should be used when users want to create a new skill (or update an existing skill) that extends Codex's capabilities with specialized knowledge, workflows, or tool integrations.</agent_skill>\n\n<agent_skill fullPath=\"c:\\Users\\Administrator\\.codex\\skills\\.system\\skill-installer\\SKILL.md\">Install Codex skills into $CODEX_HOME/skills from a curated list or a GitHub repo path. Use when a user asks to list installable skills, install a curated skill, or install a skill from another repo (including private repos).</agent_skill>\n</available_skills>\n</agent_skills>\n\n<mcp_instructions description=\"Instructions provided by MCP servers to help use them properly\">\nServer: dart\nThis server helps to connect Dart and Flutter developers to their development tools and running applications.\nIMPORTANT: Prefer using an MCP tool provided by this server over using tools directly in a shell.\n\nServer: cursor-ide-browser\nThe cursor-ide-browser is an MCP server that allows you to navigate the web and interact with the page. Use this for frontend/webapp development and testing code changes.\n\nCRITICAL - Lock/unlock workflow:\n1. browser_lock requires an existing browser tab - you CANNOT lock before browser_navigate\n2. Correct order: browser_navigate -> browser_lock -> (interactions) -> browser_unlock\n3. If a browser tab already exists (check with browser_tabs list), call browser_lock FIRST before any interactions\n4. Only call browser_unlock when completely done with ALL browser operations for this turn\n\nIMPORTANT - Before interacting with any page:\n1. Use browser_tabs with action \"list\" to see open tabs and their URLs\n2. Use browser_snapshot to get the page structure and element refs before any interaction (click, type, hover, etc.)\n\nIMPORTANT - Waiting strategy:\nWhen waiting for page changes (navigation, content loading, animations, etc.), prefer short incremental waits (1-3 seconds) with browser_snapshot checks in between rather than a single long wait. For example, instead of waiting 10 seconds, do: wait 2s -> snapshot -> check if ready -> if not, wait 2s more -> snapshot again. This allows you to proceed as soon as the page is ready rather than always waiting the maximum time.\n\nNotes:\n- Native dialogs (alert/confirm/prompt) never block automation. By default, confirm() returns true and prompt() returns the default value. To test different responses, call browser_handle_dialog BEFORE the triggering action: use accept: false for \"Cancel\", or promptText: \"value\" for custom prompt input.\n- Iframe content is not accessible - only elements outside iframes can be interacted with.\n- Use browser_type to append text, browser_fill to clear and replace. browser_fill also works on contenteditable elements.\n- For nested scroll containers, use browser_scroll with scrollIntoView: true before clicking elements that may be obscured.\n</mcp_instructions>"},{"type":"text","text":"<open_and_recently_viewed_files>\nRecently viewed files (recent at the top, oldest at the bottom):\n- D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router\\internal\\bedrockproxy\\service.go (total lines: 1405)\n\nFiles that are currently open and visible in the user's IDE:\n- D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router\\internal\\bedrockproxy\\service.go (currently focused file, cursor is on line 277, total lines: 1405)\n\nNote: these files may or may not be relevant to the current conversation. Use the read file tool if you need to get the contents of some of them.\n</open_and_recently_viewed_files>"},{"type":"text","text":"<user_query>\n用中文写一个项目说明，放到文档里面\n</user_query>"}]},{"role":"assistant","content":[{"type":"text","text":"我来帮您为这个项目创建一个中文说明文档。首先让我了解一下项目的结构和内容。"},{"type":"tool_use","id":"tooluse_Rjgoh9YqcuISHJ9xfeNVKm","name":"Read","input":{"path":"D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router"}},{"type":"tool_use","id":"tooluse_qcupMQIdOGfoE2AUUgOL2G","name":"Glob","input":{"pattern":"**/README.md"}},{"type":"tool_use","id":"tooluse_Zhcfu5l0A8USIgxdIbO2gU","name":"Glob","input":{"pattern":"*.go"}},{"type":"tool_use","id":"tooluse_NrvPPWn54htJynlIJ5GzHn","name":"Read","input":{"path":"D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router\\go.mod"}}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"tooluse_Rjgoh9YqcuISHJ9xfeNVKm","content":[{"type":"text","text":"Error: Path is a directory, not a file"}]},{"type":"tool_result","tool_use_id":"tooluse_qcupMQIdOGfoE2AUUgOL2G","content":[{"type":"text","text":"Invalid arguments:\nglob_pattern: Required"}]},{"type":"tool_result","tool_use_id":"tooluse_Zhcfu5l0A8USIgxdIbO2gU","content":[{"type":"text","text":"Invalid arguments:\nglob_pattern: Required"}]},{"type":"tool_result","tool_use_id":"tooluse_NrvPPWn54htJynlIJ5GzHn","content":[{"type":"text","text":"     1|module aws-cursor-router\n     2|\n     3|go 1.25.7\n     4|\n     5|require (\n     6|\tgithub.com/aws/aws-sdk-go-v2 v1.41.1\n     7|\tgithub.com/aws/aws-sdk-go-v2/config v1.32.7\n     8|\tgithub.com/aws/aws-sdk-go-v2/credentials v1.19.7\n     9|\tgithub.com/aws/aws-sdk-go-v2/service/bedrock v1.53.2\n    10|\tgithub.com/aws/aws-sdk-go-v2/service/bedrockruntime v1.49.0\n    11|\tgithub.com/aws/smithy-go v1.24.0\n    12|\tgithub.com/google/uuid v1.6.0\n    13|\tgithub.com/joho/godotenv v1.5.1\n    14|\tgolang.org/x/time v0.14.0\n    15|\tmodernc.org/sqlite v1.44.3\n    16|)\n    17|\n    18|require (\n    19|\tgithub.com/aws/aws-sdk-go-v2/aws/protocol/eventstream v1.7.4 // indirect\n    20|\tgithub.com/aws/aws-sdk-go-v2/feature/ec2/imds v1.18.17 // indirect\n    21|\tgithub.com/aws/aws-sdk-go-v2/internal/configsources v1.4.17 // indirect\n    22|\tgithub.com/aws/aws-sdk-go-v2/internal/endpoints/v2 v2.7.17 // indirect\n    23|\tgithub.com/aws/aws-sdk-go-v2/internal/ini v1.8.4 // indirect\n    24|\tgithub.com/aws/aws-sdk-go-v2/service/internal/accept-encoding v1.13.4 // indirect\n    25|\tgithub.com/aws/aws-sdk-go-v2/service/internal/presigned-url v1.13.17 // indirect\n    26|\tgithub.com/aws/aws-sdk-go-v2/service/signin v1.0.5 // indirect\n    27|\tgithub.com/aws/aws-sdk-go-v2/service/sso v1.30.9 // indirect\n    28|\tgithub.com/aws/aws-sdk-go-v2/service/ssooidc v1.35.13 // indirect\n    29|\tgithub.com/aws/aws-sdk-go-v2/service/sts v1.41.6 // indirect\n    30|\tgithub.com/dustin/go-humanize v1.0.1 // indirect\n    31|\tgithub.com/mattn/go-isatty v0.0.20 // indirect\n    32|\tgithub.com/ncruces/go-strftime v1.0.0 // indirect\n    33|\tgithub.com/remyoudompheng/bigfft v0.0.0-20230129092748-24d4a6f8daec // indirect\n    34|\tgolang.org/x/exp v0.0.0-20251023183803-a4bb9ffd2546 // indirect\n    35|\tgolang.org/x/sys v0.37.0 // indirect\n    36|\tmodernc.org/libc v1.67.6 // indirect\n    37|\tmodernc.org/mathutil v1.7.1 // indirect\n    38|\tmodernc.org/memory v1.11.0 // indirect\n    39|)\n    40|"}],"cache_control":{"type":"ephemeral"}}]},{"role":"assistant","content":[{"type":"tool_use","id":"tooluse_08wk0VmoDegIRQgtlXt2fV","name":"Shell","input":{"command":"ls -la","working_directory":"D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router","description":"查看项目根目录文件结构"}},{"type":"tool_use","id":"tooluse_y4ROtvr1XxfMUge7jqR8PD","name":"Read","input":{"path":"D:\\360MoveData\\Users\\Administrator\\Desktop\\AI-workspace\\salessavvy\\aws-cursor-router\\internal\\bedrockproxy\\service.go","start_line":1,"limit":50}}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"tooluse_08wk0VmoDegIRQgtlXt2fV","content":[{"type":"text","text":"Rejected: Review cancelled or failed"}],"cache_control":{"type":"ephemeral"}},{"type":"tool_result","tool_use_id":"tooluse_y4ROtvr1XxfMUge7jqR8PD","content":[{"type":"text","text":"     1|// Package bedrockproxy 实现 OpenAI 兼容的 Bedrock Converse 代理。\n     2|//\n     3|// 工具调用参数为何是多条 delta：\n     4|//\n     5|//\tBedrock ConverseStream 按 token/片段推送 toolUse.input，不会等整段 arguments 生成完再返回。\n     6|//\t与 bedrock-access-gateway 一致，默认逐条转发每个 delta，客户端需自行累积 arguments。\n     7|//\t若希望「组装好一次性发过去」，可设置 BUFFER_TOOL_CALL_ARGS=true，在 MessageStop 时发送完整参数。\n     8|//\n     9|// Cursor 兼容性对齐 bedrock-access-gateway（PR #110 / Issue #84）：\n    10|//   - BuildBedrockMessages：连续 role=tool 合并为一条 user（多个 toolResult），避免 ValidationException。\n    11|//   - 流式 tool_calls：首 chunk 带 role \"assistant\"，index 0-based；finish_reason 映射 tool_use -> tool_calls。\n    12|//   - 路由层：model 为空或 \"gpt-*\" 时使用默认模型。\n    13|package bedrockproxy\n    14|\n    15|import (\n    16|\t\"context\"\n    17|\t\"encoding/json\"\n    18|\t\"errors\"\n    19|\t\"fmt\"\n    20|\t\"sort\"\n    21|\t\"strings\"\n    22|\t\"sync\"\n    23|\n    24|\t\"aws-cursor-router/internal/openai\"\n    25|\t\"github.com/aws/aws-sdk-go-v2/aws\"\n    26|\t\"github.com/aws/aws-sdk-go-v2/service/bedrockruntime\"\n    27|\t\"github.com/aws/aws-sdk-go-v2/service/bedrockruntime/document\"\n    28|\tbrtypes \"github.com/aws/aws-sdk-go-v2/service/bedrockruntime/types\"\n    29|\tsmithydocument \"github.com/aws/smithy-go/document\"\n    30|)\n    31|\n    32|type ConverseAPI interface {\n    33|\tConverse(ctx context.Context, params *bedrockruntime.ConverseInput, optFns ...func(*bedrockruntime.Options)) (*bedrockruntime.ConverseOutput, error)\n    34|\tConverseStream(ctx context.Context, params *bedrockruntime.ConverseStreamInput, optFns ...func(*bedrockruntime.Options)) (*bedrockruntime.ConverseStreamOutput, error)\n    35|}\n    36|\n    37|type Service struct {\n    38|\tclient                ConverseAPI\n    39|\tmu                    sync.RWMutex\n    40|\tdefaultModelID        string\n    41|\tdefaultMaxOutputToken int32\n    42|\tminToolMaxOutputToken int32\n    43|\tforceToolUse          bool // 当请求包含 tools 时，强制模型调用工具\n    44|\tbufferToolCallArgs    bool // 为 true 时在流结束时一次性发送完整 tool_calls 参数（与 bedrock-access-gateway 一致时为 false，按 delta 逐条转发）\n    45|}\n    46|\n    47|type ChatResult struct {\n    48|\tText         string\n    49|\tToolCalls    []openai.ToolCall\n    50|\tInputTokens  int\n... 1532 lines not shown ..."}],"cache_control":{"type":"ephemeral"}}]}],"tools":[{"name":"Shell","description":"Executes a given command in a shell session with optional foreground timeout.\n\nIMPORTANT: This tool is for terminal operations like git, npm, docker, etc. DO NOT use it for file operations (reading, writing, editing, searching, finding files) - use the specialized tools for this instead.\n\nBefore executing the command, please follow these steps:\n\n1. Check for Running Processes:\n   - Before starting dev servers or long-running processes, list the terminals folder to check if they are already running in existing terminals.\n   - You can use this information to determine which terminal, if any, matches the command you want to run, contains the output from the command you want to inspect, or has changed since you last read them.\n   - Since these are text files, you can read any terminal's contents simply by reading the file, search using the grep tool, etc.\n2. Directory Verification:\n   - If the command will create new directories or files, first use the ls tool to verify the parent directory exists and is the correct location\n   - For example, before running \"mkdir foo/bar\", first use ls to check that \"foo\" exists and is the intended parent directory\n3. Command Execution:\n   - Always quote file paths that contain spaces with double quotes (e.g., cd \"path with spaces/file.txt\")\n   - Examples of proper quoting:\n     - cd \"/Users/name/My Documents\" (correct)\n     - cd /Users/name/My Documents (incorrect - will fail)\n     - python \"/path/with spaces/script.py\" (correct)\n     - python /path/with spaces/script.py (incorrect - will fail)\n   - After ensuring proper quoting, execute the command.\n   - Capture the output of the command.\n\nUsage notes:\n\n- The command argument is required.\n- The shell starts in the workspace root and is stateful across sequential calls. Current working directory and environment variables persist between calls. Use the `working_directory` parameter to run commands in different directories. Example: to run `npm install` in the `frontend` folder, set `working_directory: \"frontend\"` rather than using `cd frontend && npm install`.\n- It is very helpful if you write a clear, concise description of what this command does in 5-10 words.\n- VERY IMPORTANT: You MUST avoid using search commands like `find` and `grep`.Instead use Grep, Glob to search.You MUST avoid read tools like `cat`, `head`, `tail`, and `ls`, and use Read to read files.Avoid editing files with tools like `sed` and `awk`, use StrReplace instead.\n- If you _still_ need to run `grep`, STOP. ALWAYS USE ripgrep at `rg` first, which all users have pre-installed.\n- When issuing multiple commands:\n  - If the commands are independent and can run in parallel, make multiple Bash tool calls in a single message. For example, if you need to run \"git status\" and \"git diff\", send a single message with two Bash tool calls in parallel.\n  - If the commands depend on each other and must run sequentially, use a single Bash call with '&&' to chain them together (e.g., `git add . && git commit -m \"message\" && git push`). For instance, if one operation must complete before another starts (like mkdir before cp,Write before Bash for git operations, or git add before git commit), run these operations sequentially instead.\n  - Use ';' only when you need to run commands sequentially but don't care if earlier commands fail\n  - DO NOT use newlines to separate commands (newlines are ok in quoted strings)\n\nDependencies:\n\nWhen adding new dependencies, prefer using the package manager (e.g. npm, pip) to add the latest version. Do not make up dependency versions.\n\n<managing-long-running-commands>\n- Commands that don't complete within `block_until_ms` (default 30s) are moved to background. The command keeps running and output streams to a terminal file. Set `block_until_ms: 0` to immediately background (use for dev servers, watchers, or any long-running process).\n- You do not need to use '&' at the end of commands.\n- Make sure to set `block_until_ms` to higher than the command's expected runtime. Add some buffer since block_until_ms includes shell startup time; increase buffer next time based on `elapsed_ms` if you chose too low. E.g. if you sleep for 40s, recommended `block_until_ms` is 45s.\n- Monitoring backgrounded commands:\n  - When command moves to background, check status immediately by reading the terminal file.\n  - Header has `pid` and `running_for_seconds` (updated every 5s)\n  - When finished, footer with `exit_code` and `elapsed_ms` appears.\n  - Poll repeatedly to monitor by sleeping between checks. If the file gets large, read from the end of the file to capture the latest content.\n  - Pick your sleep intervals using best guess/judgment based on any knowledge you have about the command and its expected runtime, and any output from monitoring the command. When no new output, exponential backoff is a good strategy (e.g. sleep 2s, 4s, 8s, 16s...), using educated guess for min and max wait.\n  - If it's longer than expected and the command seems like it is hung, kill the process if safe to do so using the pid that appears in the header. If possible, try to fix the hang and proceed.\n  - Don't stop polling until: (a) `exit_code` footer appears (terminating command), (b) the command reaches a healthy steady state (only for non-terminating command, e.g. dev server/watcher), or (c) command is hung - follow guidance above.\n</managing-long-running-commands>\n\n<committing-changes-with-git>\nOnly create commits when requested by the user. If unclear, ask first. When the user asks you to create a new git commit, follow these steps carefully:\n\nGit Safety Protocol:\n\n- NEVER update the git config\n- NEVER run destructive/irreversible git commands (like push --force, hard reset, etc) unless the user explicitly requests them\n- NEVER skip hooks (--no-verify, --no-gpg-sign, etc) unless the user explicitly requests it\n- NEVER run force push to main/master, warn the user if they request it\n- Avoid git commit --amend. ONLY use --amend when ALL conditions are met:\n  1. User explicitly requested amend, OR commit SUCCEEDED but pre-commit hook auto-modified files that need including\n  2. HEAD commit was created by you in this conversation (verify: git log -1 --format='%an %ae')\n  3. Commit has NOT been pushed to remote (verify: git status shows \"Your branch is ahead\")\n- CRITICAL: If commit FAILED or was REJECTED by hook, NEVER amend - fix the issue and create a NEW commit\n- CRITICAL: If you already pushed to remote, NEVER amend unless user explicitly requests it (requires force push)\n- NEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\n\n1. You can call multiple tools in a single response. When multiple independent pieces of information are requested, batch your tool calls together for optimal performance. ALWAYS run the following shell commands in parallel, each using the Shell tool:\n   - Run a git status command to see all untracked files.\n   - Run a git diff command to see both staged and unstaged changes that will be committed.\n   - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\n2. Analyze all staged changes (both previously staged and newly added) and draft a commit message:\n   - Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.). Ensure the message accurately reflects the changes and their purpose (i.e. \"add\" means a wholly new feature, \"update\" means an enhancement to an existing feature, \"fix\" means a bug fix, etc.).\n   - Do not commit files that likely contain secrets (.env, credentials.json, etc). Warn the user if they specifically request to commit those files\n   - Draft a concise (1-2 sentences) commit message that focuses on the \"why\" rather than the \"what\"\n   - Ensure it accurately reflects the changes and their purpose\n3. Run the following commands sequentially:\n   - Add relevant untracked files to the staging area.\n   - Commit the changes with the message.\n   - Run git status after the commit completes to verify success.\n4. If the commit fails due to pre-commit hook, fix the issue and create a NEW commit (see amend rules above)\n\nImportant notes:\n\n- NEVER update the git config\n- NEVER run additional commands to read or explore code, besides git shell commands\n- DO NOT push to the remote repository unless the user explicitly asks you to do so\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\n\n<example>git commit -m \"$(cat <<'EOF'\nCommit message here.\n\nEOF\n)\"</example>\n</committing-changes-with-git>\n\n<creating-pull-requests>\nUse the gh command via the Shell tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\n\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\n\n1. You have the capability to call multiple tools in a single response. When multiple independent pieces of information are requested, batch your tool calls together for optimal performance. ALWAYS run the following shell commands in parallel using the Shell tool, in order to understand the current state of the branch since it diverged from the main branch:\n   - Run a git status command to see all untracked files\n   - Run a git diff command to see both staged and unstaged changes that will be committed\n   - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\n   - Run a git log command and `git diff [base-branch]...HEAD` to understand the full commit history for the current branch (from the time it diverged from the base branch)\n2. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (NOT just the latest commit, but ALL commits that will be included in the pull request!!!), and draft a pull request summary\n3. Run the following commands sequentially:\n   - Create new branch if needed\n   - Push to remote with -u flag if needed\n   - Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\n\n<example># First, push the branch (with required_permissions: [\"all\"])\ngit push -u origin HEAD\n\n# Then create the PR (with required_permissions: [\"all\"])\ngh pr create --title \"the pr title\" --body \"$(cat <<'EOF'\n## Summary\n<1-3 bullet points>\n\n## Test plan\n[Checklist of TODOs for testing the pull request...]\n\nEOF\n)\"</example>\n\nImportant:\n\n- NEVER update the git config\n- DO NOT use the TodoWrite or Task tools\n- Return the PR URL when you're done, so the user can see it\n</creating-pull-requests>\n\n<other-common-operations>\n- View comments on a Github PR: gh api repos/foo/bar/pulls/123/comments\n</other-common-operations>","input_schema":{"type":"object","properties":{"command":{"type":"string","description":"The command to execute"},"working_directory":{"type":"string","description":"The absolute path to the working directory to execute the command in (defaults to current directory)"},"block_until_ms":{"type":"number","description":"How long to block and wait for the command to complete before moving it to background (in milliseconds). Defaults to 30000ms (30 seconds). Set to 0 to immediately run the command in the background. The timer includes the shell startup time."},"description":{"type":"string","description":"Clear, concise description of what this command does in 5-10 words"}},"required":["command"]}},{"name":"Glob","description":"\nTool to search for files matching a glob pattern\n\n- Works fast with codebases of any size\n- Returns matching file paths sorted by modification time\n- Use this tool when you need to find files by name patterns\n- You have the capability to call multiple tools in a single response. It is always better to speculatively perform multiple searches that are potentially useful as a batch.\n","input_schema":{"type":"object","properties":{"target_directory":{"type":"string","description":"Absolute path to directory to search for files in. If not provided, defaults to Cursor workspace root."},"glob_pattern":{"type":"string","description":"The glob pattern to match files against.\nPatterns not starting with \"**/\" are automatically prepended with \"**/\" to enable recursive searching.\n\nExamples:\n\t- \"*.js\" (becomes \"**/*.js\") - find all .js files\n\t- \"**/node_modules/**\" - find all node_modules directories\n\t- \"**/test/**/test_*.ts\" - find all test_*.ts files in any test directory"}},"required":["glob_pattern"]}},{"name":"Grep","description":"A powerful search tool built on ripgrep\nUsage:\n- Prefer using Grep for search tasks when you know the exact symbols or strings to search for. Whenever possible, use this tool instead of invoking grep or rg as a terminal command. The Grep tool has been optimized for speed and file restrictions inside Cursor.\n- Supports full regex syntax (e.g., \"log.*Error\", \"function\\s+\\w+\")\n- Filter files with glob parameter (e.g., \".js\", \"**/.tsx\") or type parameter (e.g., \"js\", \"py\", \"rust\")\n- Output modes: \"content\" shows matching lines (default), \"files_with_matches\" shows only file paths, \"count\" shows match counts\n- Pattern syntax: Uses ripgrep (not grep) - literal braces need escaping (use interface\\{\\} to find interface{} in Go code)\n- Multiline matching: By default patterns match within single lines only. For cross-line patterns like struct \\{[\\s\\S]*?field, use multiline: true\n- Results are capped to several thousand output lines for responsiveness; when truncation occurs, the results report \"at least\" counts, but are otherwise accurate.\n- Content output formatting closely follows ripgrep output format: '-' for context lines, ':' for match lines, and all context/match lines below each file group.","input_schema":{"type":"object","properties":{"pattern":{"type":"string","description":"The regular expression pattern to search for in file contents"},"path":{"type":"string","description":"File or directory to search in (rg pattern -- PATH). Defaults to Cursor workspace root."},"glob":{"type":"string","description":"Glob pattern to filter files (e.g. \"*.js\", \"*.{ts,tsx}\") - maps to rg --glob"},"output_mode":{"type":"string","enum":["content","files_with_matches","count"],"description":"Output mode: \"content\" shows matching lines (supports -A/-B/-C context, -n line numbers, head_limit), \"files_with_matches\" shows file paths (supports head_limit), \"count\" shows match counts (supports head_limit). Defaults to \"content\"."},"-B":{"type":"number","description":"Number of lines to show before each match (rg -B). Requires output_mode: \"content\", ignored otherwise."},"-A":{"type":"number","description":"Number of lines to show after each match (rg -A). Requires output_mode: \"content\", ignored otherwise."},"-C":{"type":"number","description":"Number of lines to show before and after each match (rg -C). Requires output_mode: \"content\", ignored otherwise."},"-i":{"type":"boolean","description":"Case insensitive search (rg -i) Defaults to false"},"type":{"type":"string","description":"File type to search (rg --type). Common types: js, py, rust, go, java, etc. More efficient than include for standard file types."},"head_limit":{"type":"number","minimum":0,"description":"Limit output size. For \"content\" mode: limits total matches shown. For \"files_with_matches\" and \"count\" modes: limits number of files."},"offset":{"type":"number","minimum":0,"description":"Skip first N entries. For \"content\" mode: skips first N matches. For \"files_with_matches\" and \"count\" modes: skips first N files. Use with head_limit for pagination."},"multiline":{"type":"boolean","description":"Enable multiline mode where . matches newlines and patterns can span lines (rg -U --multiline-dotall). Default: false."}},"required":["pattern"]}},{"name":"Read","description":"Reads a file from the local filesystem. You can access any file directly by using this tool.\nIf the User provides a path to a file assume that path is valid. It is okay to read a file that does not exist; an error will be returned.\n\nUsage:\n- You can optionally specify a line offset and limit (especially handy for long files), but it's recommended to read the whole file by not providing these parameters\n- Lines in the output are numbered starting at 1, using following format: LINE_NUMBER|LINE_CONTENT\n- You have the capability to call multiple tools in a single response. It is always better to speculatively read multiple files as a batch that are potentially useful.\n- If you read a file that exists but has empty contents you will receive 'File is empty.'\n\nImage Support:\n- This tool can also read image files when called with the appropriate path.\n- Supported image formats: jpeg/jpg, png, gif, webp.\n\nPDF Support:\n- PDF files are converted into text content automatically (subject to the same character limits as other files).","input_schema":{"type":"object","properties":{"path":{"type":"string","description":"The absolute path of the file to read."},"offset":{"type":"number","description":"The line number to start reading from. Positive values are 1-indexed from the start of the file. Negative values count backwards from the end (e.g. -1 is the last line). Only provide if the file is too large to read at once."},"limit":{"type":"number","description":"The number of lines to read. Only provide if the file is too large to read at once."}},"required":["path"]}},{"name":"Delete","description":"Deletes a file at the specified path. The operation will fail gracefully if:\n    - The file doesn't exist\n    - The operation is rejected for security reasons\n    - The file cannot be deleted","input_schema":{"type":"object","properties":{"path":{"type":"string","description":"The absolute path of the file to delete"}},"required":["path"]}},{"name":"StrReplace","description":"Performs exact string replacements in files.\n\nUsage:\n- When editing text, ensure you preserve the exact indentation (tabs/spaces) as it appears before.\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\n- The edit will FAIL if old_string is not unique in the file. Either provide a larger string with more surrounding context to make it unique or use replace_all to change every instance of old_string.\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\n- Optional parameter: replace_all (boolean, default false) — if true, replaces all occurrences of old_string in the file.\n\nIf you want to create a new file, use the Write tool instead.","input_schema":{"type":"object","properties":{"path":{"type":"string","description":"The absolute path to the file to modify"},"old_string":{"type":"string","description":"The text to replace"},"new_string":{"type":"string","description":"The text to replace it with (must be different from old_string)"},"replace_all":{"type":"boolean","description":"Replace all occurrences of old_string (default false)"}},"required":["path","old_string","new_string"]}},{"name":"Write","description":"Writes a file to the local filesystem.\n\nUsage:\n- This tool will overwrite the existing file if there is one at the provided path.\n- ALWAYS prefer editing existing files in the codebase. NEVER write new files unless explicitly required.\n- NEVER proactively create documentation files (*.md) or README files. Only create documentation files if explicitly requested by the User.","input_schema":{"type":"object","properties":{"path":{"type":"string","description":"The absolute path to the file to modify"},"contents":{"type":"string","description":"The contents to write to the file"}},"required":["path","contents"]}},{"name":"EditNotebook","description":"Use this tool to edit a jupyter notebook cell. Use ONLY this tool to edit notebooks.\n\nThis tool supports editing existing cells and creating new cells:\n\t- If you need to edit an existing cell, set 'is_new_cell' to false and provide the 'old_string' and 'new_string'.\n\t\t-- The tool will replace ONE occurrence of 'old_string' with 'new_string' in the specified cell.\n\t- If you need to create a new cell, set 'is_new_cell' to true and provide the 'new_string' (and keep 'old_string' empty).\n\t- It's critical that you set the 'is_new_cell' flag correctly!\n\t- This tool does NOT support cell deletion, but you can delete the content of a cell by passing an empty string as the 'new_string'.\n\nOther requirements:\n\t- Cell indices are 0-based.\n\t- 'old_string' and 'new_string' should be a valid cell content, i.e. WITHOUT any JSON syntax that notebook files use under the hood.\n\t- The old_string MUST uniquely identify the specific instance you want to change. This means:\n\t\t-- Include AT LEAST 3-5 lines of context BEFORE the change point\n\t\t-- Include AT LEAST 3-5 lines of context AFTER the change point\n\t- This tool can only change ONE instance at a time. If you need to change multiple instances:\n\t\t-- Make separate calls to this tool for each instance\n\t\t-- Each call must uniquely identify its specific instance using extensive context\n\t- This tool might save markdown cells as \"raw\" cells. Don't try to change it, it's fine. We need it to properly display the diff.\n\t- If you need to create a new notebook, just set 'is_new_cell' to true and cell_idx to 0.\n\t- ALWAYS generate arguments in the following order: target_notebook, cell_idx, is_new_cell, cell_language, old_string, new_string.\n\t- Prefer editing existing cells over creating new ones!\n\t- ALWAYS provide ALL required arguments (including BOTH old_string and new_string). NEVER call this tool without providing 'new_string'.","input_schema":{"type":"object","properties":{"target_notebook":{"type":"string","description":"The path to the notebook file you want to edit. You can use either a relative path in the workspace or an absolute path. If an absolute path is provided, it will be preserved as is."},"cell_idx":{"type":"number","description":"The index of the cell to edit (0-based)"},"is_new_cell":{"type":"boolean","description":"If true, a new cell will be created at the specified cell index. If false, the cell at the specified cell index will be edited."},"cell_language":{"type":"string","description":"The language of the cell to edit. Should be STRICTLY one of these: 'python', 'markdown', 'javascript', 'typescript', 'r', 'sql', 'shell', 'raw' or 'other'."},"old_string":{"type":"string","description":"The text to replace (must be unique within the cell, and must match the cell contents exactly, including all whitespace and indentation)."},"new_string":{"type":"string","description":"The edited text to replace the old_string or the content for the new cell."}},"required":["target_notebook","cell_idx","is_new_cell","cell_language","old_string","new_string"]}},{"name":"TodoWrite","description":"Use this tool to create and manage a structured task list for your current coding session. This helps track progress, organize complex tasks, and demonstrate thoroughness.\n\nNote: Other than when first creating todos, don't tell the user you're updating todos, just do it.\n\n### When to Use This Tool\n\nUse proactively for:\n1. Complex multi-step tasks (3+ distinct steps)\n2. Non-trivial tasks requiring careful planning\n3. User explicitly requests todo list\n4. User provides multiple tasks (numbered/comma-separated)\n5. After receiving new instructions - capture requirements as todos (use merge=false to add new ones)\n6. After completing tasks - mark complete with merge=true and add follow-ups\n7. When starting new tasks - mark as in_progress (ideally only one at a time)\n\n### When NOT to Use\n\nSkip for:\n1. Single, straightforward tasks\n2. Trivial tasks with no organizational benefit\n3. Tasks completable in < 3 trivial steps\n4. Purely conversational/informational requests\n5. Don't add a task to test the change unless asked, or you'll overfocus on testing\n\n### Examples\n\n<example>\n  User: Add dark mode toggle to settings\n  Assistant:\n    - *Creates todo list:*\n      1. Add state management [in_progress]\n      2. Implement styles\n      3. Create toggle component\n      4. Update components\n    - [Immediately begins working on todo 1 in the same tool call batch]\n<reasoning>\n  Multi-step feature with dependencies.\n</reasoning>\n</example>\n\n<example>\n  User: Rename getCwd to getCurrentWorkingDirectory across my project\n  Assistant: *Searches codebase, finds 15 instances across 8 files*\n  *Creates todo list with specific items for each file that needs updating*\n\n<reasoning>\n  Complex refactoring requiring systematic tracking across multiple files.\n</reasoning>\n</example>\n\n<example>\n  User: Implement user registration, product catalog, shopping cart, checkout flow.\n  Assistant: *Creates todo list breaking down each feature into specific tasks*\n\n<reasoning>\n  Multiple complex features provided as list requiring organized task management.\n</reasoning>\n</example>\n\n<example>\n  User: Optimize my React app - it's rendering slowly.\n  Assistant: *Analyzes codebase, identifies issues*\n  *Creates todo list: 1) Memoization, 2) Virtualization, 3) Image optimization, 4) Fix state loops, 5) Code splitting*\n\n<reasoning>\n  Performance optimization requires multiple steps across different components.\n</reasoning>\n</example>\n\n### Examples of When NOT to Use the Todo List\n\n<example>\n  User: What does git status do?\n  Assistant: Shows current state of working directory and staging area...\n\n<reasoning>\n  Informational request with no coding task to complete.\n</reasoning>\n</example>\n\n<example>\n  User: Add comment to calculateTotal function.\n  Assistant: *Uses edit tool to add comment*\n\n<reasoning>\n  Single straightforward task in one location.\n</reasoning>\n</example>\n\n<example>\n  User: Run npm install for me.\n  Assistant: *Executes npm install* Command completed successfully...\n\n<reasoning>\n  Single command execution with immediate results.\n</reasoning>\n</example>\n\n### Task States and Management\n\n1. **Task States:**\n  - pending: Not yet started\n  - in_progress: Currently working on\n  - completed: Finished successfully\n  - cancelled: No longer needed\n\n2. **Task Management:**\n  - Update status in real-time\n  - Mark complete IMMEDIATELY after finishing\n  - Only ONE task in_progress at a time\n  - Complete current tasks before starting new ones\n\n3. **Task Breakdown:**\n  - Create specific, actionable items\n  - Break complex tasks into manageable steps\n  - Use clear, descriptive names\n\n4. **Parallel Todo Writes:**\n  - Prefer creating the first todo as in_progress\n  - Start working on todos by using tool calls in the same tool call batch as the todo write\n  - Batch todo updates with other tool calls for better latency and lower costs for the user\n\nWhen in doubt, use this tool. Proactive task management demonstrates attentiveness and ensures complete requirements.","input_schema":{"type":"object","properties":{"todos":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for the TODO item"},"content":{"type":"string","description":"The description/content of the todo item"},"status":{"type":"string","enum":["pending","in_progress","completed","cancelled"],"description":"The current status of the TODO item"}},"required":["id","content","status"]},"minItems":2,"description":"Array of TODO items to update or create"},"merge":{"type":"boolean","description":"Whether to merge the todos with the existing todos. If true, the todos will be merged into the existing todos based on the id field. You can leave unchanged properties undefined. If false, the new todos will replace the existing todos."}},"required":["todos","merge"]}},{"name":"ReadLints","description":"Read and display linter errors from the current workspace. You can provide paths to specific files or directories, or omit the argument to get diagnostics for all files.\n\n- If a file path is provided, returns diagnostics for that file only\n- If a directory path is provided, returns diagnostics for all files within that directory\n- If no path is provided, returns diagnostics for all files in the workspace\n- This tool can return linter errors that were already present before your edits, so avoid calling it with a very wide scope of files\n- NEVER call this tool on a file unless you've edited it or are about to edit it","input_schema":{"type":"object","properties":{"paths":{"type":"array","items":{"type":"string"},"description":"Optional. An array of paths to files or directories to read linter errors for. You can use either relative paths in the workspace or absolute paths. If provided, returns diagnostics for the specified files/directories only. If not provided, returns diagnostics for all files in the workspace."}}}},{"name":"SemanticSearch","description":"`SemanticSearch`: semantic search that finds code by meaning, not exact text\n\n### When to Use This Tool\n\nUse `SemanticSearch` when you need to:\n- Explore unfamiliar codebases\n- Ask \"how / where / what\" questions to understand behavior\n- Find code by meaning rather than exact text\n\n### When NOT to Use\n\nSkip `SemanticSearch` for:\n1. Exact text matches (use `Grep`)\n2. Reading known files (use `Read`)\n3. Simple symbol lookups (use `Grep`)\n4. Find file by name (use `Glob`)\n\n### Examples\n\n<example>\n  Query: \"Where is interface MyInterface implemented in the frontend?\"\n<reasoning>\n  Good: Complete question asking about implementation location with specific context (frontend).\n</reasoning>\n</example>\n\n<example>\n  Query: \"Where do we encrypt user passwords before saving?\"\n<reasoning>\n  Good: Clear question about a specific process with context about when it happens.\n</reasoning>\n</example>\n\n<example>\n  Query: \"MyInterface frontend\"\n<reasoning>\n  BAD: Too vague; use a specific question instead. This would be better as \"Where is MyInterface used in the frontend?\"\n</reasoning>\n</example>\n\n<example>\n  Query: \"AuthService\"\n<reasoning>\n  BAD: Single word searches should use `Grep` for exact text matching instead.\n</reasoning>\n</example>\n\n<example>\n  Query: \"What is AuthService? How does AuthService work?\"\n<reasoning>\n  BAD: Combines two separate queries. A single semantic search is not good at looking for multiple things in parallel. Split into separate parallel searches: like \"What is AuthService?\" and \"How does AuthService work?\"\n</reasoning>\n</example>\n\n### Target Directories\n\n- Provide ONE directory or file path; [] searches the whole repo. No globs or wildcards.\n  Good:\n  - [\"backend/api/\"]   - focus directory\n  - [\"src/components/Button.tsx\"] - single file\n  - [] - search everywhere when unsure\n  BAD:\n  - [\"frontend/\", \"backend/\"] - multiple paths\n  - [\"src/**/utils/**\"] - globs\n  - [\"*.ts\"] or [\"**/*\"] - wildcard paths\n\n### Search Strategy\n\n1. Start with exploratory queries - semantic search is powerful and often finds relevant context in one go. Begin broad with [] if you're not sure where relevant code is.\n2. Review results; if a directory or file stands out, rerun with that as the target.\n3. Break large questions into smaller ones (e.g. auth roles vs session storage).\n4. For big files (>1K lines) run `SemanticSearch`, or `Grep` if you know the exact symbols you're looking for, scoped to that file instead of reading the entire file.\n\n<example>\n  Step 1: { \"query\": \"How does user authentication work?\", \"target_directories\": [], \"explanation\": \"Find auth flow\" }\n  Step 2: Suppose results point to backend/auth/ → rerun:\n          { \"query\": \"Where are user roles checked?\", \"target_directories\": [\"backend/auth/\"], \"explanation\": \"Find role logic\" }\n<reasoning>\n  Good strategy: Start broad to understand overall system, then narrow down to specific areas based on initial results.\n</reasoning>\n</example>\n\n<example>\n  Query: \"How are websocket connections handled?\"\n  Target: [\"backend/services/realtime.ts\"]\n<reasoning>\n  Good: We know the answer is in this specific file, but the file is too large to read entirely, so we use semantic search to find the relevant parts.\n</reasoning>\n</example>\n\n### Usage\n- When full chunk contents are provided, avoid re-reading the exact same chunk contents using the Read tool.\n- Sometimes, just the chunk signatures and not the full chunks will be shown. Chunk signatures are usually Class or Function signatures that chunks are contained in. Use the Read or Grep tools to explore these chunks or files if you think they might be relevant.\n- When reading chunks that weren't provided as full chunks (e.g. only as line ranges or signatures), you'll sometimes want to expand the chunk ranges to include the start of the file to see imports, expand the range to include lines from the signature, or expand the range to read multiple chunks from a file at once.","input_schema":{"type":"object","properties":{"query":{"type":"string","description":"A complete question about what you want to understand. Ask as if talking to a colleague: 'How does X work?', 'What happens when Y?', 'Where is Z handled?'"},"target_directories":{"type":"array","items":{"type":"string"},"description":"Prefix directory paths to limit search scope (single directory only, no glob patterns)"},"num_results":{"type":"integer","minimum":1,"maximum":15,"description":"The number of results to return. Defaults to 15. Do not specify a value larger than 15."}},"required":["query","target_directories"]}},{"name":"WebSearch","description":"Search the web for real-time information about any topic. Returns summarized information from search results and relevant URLs.\n\nUse this tool when you need up-to-date information that might not be available or correct in your training data, or when you need to verify current facts.\nThis includes queries about:\n- Libraries, frameworks, and tools whose APIs, best practices, or usage instructions are frequently updated. (\"How do I run Postgres in a container?\")\n- Current events or technology news. (\"Which AI model is best for coding?\")\n- Informational queries similar to what you might Google (\"kubernetes operator for mysql\")\n\nIMPORTANT - Use the correct year in search queries:\n- Today's date is 2026-02-12. You MUST use this year when searching for recent information, documentation, or current events.\n- Example: If today is 2026-07-15 and the user asks for \"latest React docs\", search for \"React documentation 2026\", NOT \"React documentation 2025\"","input_schema":{"type":"object","properties":{"search_term":{"type":"string","description":"The search term to look up on the web. Be specific and include relevant keywords for better results. For technical queries, include version numbers or dates if relevant."},"explanation":{"type":"string","description":"One sentence explanation as to why this tool is being used, and how it contributes to the goal."}},"required":["search_term"]}},{"name":"WebFetch","description":"Fetch content from a specified URL and return its contents in a readable markdown format. Use this tool when you need to retrieve and analyze web content.\n\n- The URL must be a fully-formed, valid URL.\n- This tool is read-only and will not work for requests intended to have side effects.\n- This fetch tries to return live results but may return previously cached content.\n- This fetch runs from an isolated server - hosts like localhost or private IPs will not work.\n- Authentication is not supported, and an error will be returned if the URL requires authentication.\n- If the URL is returning a non-200 status code, e.g. 404, the tool will not return the content and will instead return an error message.\n","input_schema":{"type":"object","properties":{"url":{"type":"string","description":"The URL to fetch. The content will be converted to a readable markdown format."}},"required":["url"]}},{"name":"GenerateImage","description":"Generate an image file from a text description.\n\nSTRICT INVOCATION RULES (must follow):\n- Only use this tool when the user explicitly asks for an image. Do not generate images \"just to be helpful\".\n- Do not use this tool for data heavy visualizations such as charts, plots, tables.\n\nGeneral guidelines:\n- Provide a concrete description first: subject(s), layout, style, colors, text (if any), and constraints.\n- If the user provides reference images, include them in `reference_image_paths`.\n- Do not embed Markdown images in your response, the client will display the images automatically.\n\nExamples that should call this tool:\n- user: \"Generate an app icon for a note-taking app, minimal flat vector style.\" (explicitly requests an image asset)\n- user: \"Make a UI mockup of a settings screen with a dark mode toggle.\" (explicitly requests a UI mockup)\n- user: \"Generate an asset of a game character with a sword.\" (explicitly requests a visual asset)\n\nExamples that should not call this tool:\n- user: \"Create a plan to refactor this module.\" (planning request; respond in text or mermaid diagram)\n- user: \"Generate a chart of sales and revenue using data.csv.\" (data visualization; generate via code)\n","input_schema":{"type":"object","properties":{"description":{"type":"string","description":"A detailed description of the image."},"filename":{"type":"string","description":"Optional filename for the generated image (e.g., 'diagram.png'). Do not include a directory path - the tool automatically handles where to save and how to display the image. If not provided, a timestamped filename will be generated."},"reference_image_paths":{"type":"array","items":{"type":"string"},"description":"Optional array of file paths to reference images as additional inputs."}},"required":["description"]}},{"name":"AskQuestion","description":"Collect structured multiple-choice answers from the user.\nProvide one or more questions with options, and set allow_multiple when multi-select is appropriate.\n\nUse this tool when you need to gather specific information from the user through a structured question format.\nEach question should have:\n- A unique id (used to match answers)\n- A clear prompt/question text\n- At least 2 options for the user to choose from\n- An optional allow_multiple flag (defaults to false for single-select)\n\nBy default, the tool will present the questions to the user and wait for their responses before continuing.","input_schema":{"type":"object","properties":{"title":{"type":"string","description":"Optional title for the questions form"},"questions":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for this question"},"prompt":{"type":"string","description":"The question text to display to the user"},"options":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for this option"},"label":{"type":"string","description":"Display text for this option"}},"required":["id","label"]},"minItems":2,"description":"Array of answer options (minimum 2 required)"},"allow_multiple":{"type":"boolean","description":"If true, user can select multiple options. Defaults to false."}},"required":["id","prompt","options"]},"minItems":1,"description":"Array of questions to present to the user (minimum 1 required)"}},"required":["questions"]}},{"name":"Task","description":"Launch a new agent to handle complex, multi-step tasks autonomously.\n\nThe Task tool launches specialized subagents (subprocesses) that autonomously handle complex tasks. Each subagent_type has specific capabilities and tools available to it.\n\nWhen using the Task tool, you must specify a subagent_type parameter to select which agent type to use.\n\nVERY IMPORTANT: When exploring the codebase to gather context or to answer a question that is not a needle query for a specific file/class/function, it is STRONGLY RECOMMENDED that you use the Task tool with subagent_type=\"explore\" instead of running search commands directly.\n\nExamples:\n- user: \"Where is the ClientError class defined?\" assistant: [Uses Grep directly - this is a needle query for a specific class]\n- user: \"How does authentication work in this codebase?\" assistant: [Uses the Task tool with subagent_type=\"explore\" - this requires exploring multiple files to understand the auth flow]\n- user: \"What is the codebase structure?\" assistant: [Uses the Task tool with subagent_type=\"explore\"]\n\nIf it is possible to explore different areas of the codebase in parallel, you should launch multiple agents concurrently.\n\nWhen NOT to use the Task tool:\n- Simple, single or few-step tasks that can be performed by a single agent (using parallel or sequential tool calls) -- just call the tools directly instead.\n- For example:\n  - If you want to read a specific file path, use the Read or Glob tool instead of the Task tool, to find the match more quickly\n  - If you are searching for a specific class definition like \"class Foo\", use the Glob tool instead, to find the match more quickly\n  - If you are searching for code within a specific file or set of 2-3 files, use the Read tool instead of the Task tool, to find the match more quickly\n\nUsage notes:\n- Always include a short description (3-5 words) summarizing what the agent will do\n- Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses. IMPORTANT: DO NOT launch more than 4 agents concurrently.\n- When the agent is done, it will return a single message back to you. Specify exactly what information the agent should return back in its final response to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\n- Agents can be resumed using the `resume` parameter by passing the agent ID from a previous invocation. When resumed, the agent continues with its full previous context preserved. When NOT resuming, each invocation starts fresh and you should provide a detailed task description with all necessary context.\n- When using the Task tool, the subagent invocation does not have access to the user's message or prior assistant steps. Therefore, you should provide a highly detailed task description with all necessary context for the agent to perform its task autonomously.\n- The subagent's outputs should generally be trusted\n- Clearly tell the subagent which tasks you want it to perform, since it is not aware of the user's intent or your prior assistant steps (tool calls, thinking, or messages).\n- If the subagent description mentions that it should be used proactively, then you should try your best to use it without the user having to ask for it first. Use your judgement.\n- If the user specifies that they want you to run subagents \"in parallel\", you MUST send a single message with multiple Task tool use content blocks. For example, if you need to launch both a code-reviewer subagent and a test-runner subagent in parallel, send a single message with both tool calls.\n\nAvailable subagent_types and a quick description of what they do:\n- generalPurpose: General-purpose agent for researching complex questions, searching for code, and executing multi-step tasks. Use when searching for a keyword or file and not confident you'll find the match quickly.\n- explore: Fast agent specialized for exploring codebases. Use this when you need to quickly find files by patterns (eg. \"src/components/**/*.tsx\"), search code for keywords (eg. \"API endpoints\"), or answer questions about the codebase (eg. \"how do API endpoints work?\"). When calling this agent, specify the desired thoroughness level: \"quick\" for basic searches, \"medium\" for moderate exploration, or \"very thorough\" for comprehensive analysis across multiple locations and naming conventions.\n- shell: Command execution specialist for running bash commands. Use this for git operations, command execution, and other terminal tasks.\n- browser-use: Perform browser-based testing and web automation. This subagent can navigate web pages, interact with elements, fill forms, and take screenshots. Use this for testing web applications, verifying UI changes, or any browser-based tasks. Use this browser subagent when you need to either: (1) parallelize browser tasks alongside other work, or (2) execute a longer sequence of browser actions that benefit from dedicated context. For simple, single browser actions, you may use the browser tools directly. This subagent_type is stateful; if a browserUse subagent already exists, the previously created subagent will be resumed if you reuse the Task tool with subagent_type set to browserUse. (Auto-resumes most recent agent of this type; `resume` arg is ignored)\n\nAvailable models:\n- fast (cost: 1/10, intelligence: 5/10): Extremely fast, moderately intelligent model that is effective for tightly scoped changes. Not well-suited for long-horizon tasks or deep investigations.\n\nWhen speaking to the USER about which model you selected for a Task/subagent, do NOT reveal these internal model alias names (e.g., fast, alpha, beta, gamma). Instead, use natural language such as \"a faster model\", \"a more capable model\", or \"the default model\".\n\nWhen choosing a model, prefer `fast` for quick, straightforward tasks to minimize cost and latency. Only choose a named alternative model when there is a specific reason — for example, the task requires deep multi-step reasoning, very high code quality, multimodal understanding, or the user explicitly requests a more capable model.","input_schema":{"type":"object","properties":{"description":{"type":"string","description":"A short (3-5 word) description of the task"},"prompt":{"type":"string","description":"The task for the agent to perform"},"model":{"type":"string","enum":["fast"],"description":"Optional model to use for this agent. If not specified, inherits from parent. Prefer fast for quick, straightforward tasks to minimize cost and latency. Only select a different model when the task specifically benefits from it (e.g., deep reasoning, high-quality code review, multimodal input)"},"resume":{"type":"string","description":"Optional agent ID to resume from. If provided, the agent will continue from the previous execution transcript."},"readonly":{"type":"boolean","description":"If true, the subagent will run in readonly mode with restricted write operations."},"subagent_type":{"type":"string","enum":["generalPurpose","explore","shell","browser-use"],"description":"Subagent type to use for this task. Must be one of: generalPurpose, explore, shell, browser-use."},"attachments":{"type":"array","items":{"type":"string"},"description":"Optional array of file paths to images or videos to pass to the subagent. Files are read and attached to the subagent's context. Supports image formats (png, jpg, gif, webp) and video formats (mp4, webm) for Gemini models."}},"required":["description","prompt"]}},{"name":"user-Framelink_Figma_MCP-get_figma_data","description":"Get comprehensive Figma file data including layout, content, visuals, and component information","input_schema":{"type":"object","properties":{"fileKey":{"type":"string","pattern":"^[a-zA-Z0-9]+$","description":"The key of the Figma file to fetch, often found in a provided URL like figma.com/(file|design)/<fileKey>/..."},"nodeId":{"type":"string","pattern":"^I?\\d+[:|-]\\d+(?:;\\d+[:|-]\\d+)*$","description":"The ID of the node to fetch, often found as URL parameter node-id=<nodeId>, always use if provided. Use format '1234:5678' or 'I5666:180910;1:10515;1:10336' for multiple nodes."},"depth":{"type":"number","description":"OPTIONAL. Do NOT use unless explicitly requested by the user. Controls how many levels deep to traverse the node tree."}},"required":["fileKey"],"additionalProperties":false,"$schema":"http://json-schema.org/draft-07/schema#"}},{"name":"user-Framelink_Figma_MCP-download_figma_images","description":"Download SVG and PNG images used in a Figma file based on the IDs of image or icon nodes","input_schema":{"type":"object","properties":{"fileKey":{"type":"string","pattern":"^[a-zA-Z0-9]+$","description":"The key of the Figma file containing the images"},"nodes":{"type":"array","items":{"type":"object","properties":{"nodeId":{"type":"string","pattern":"^I?\\d+[:|-]\\d+(?:;\\d+[:|-]\\d+)*$","description":"The ID of the Figma image node to fetch, formatted as 1234:5678"},"imageRef":{"type":"string","description":"If a node has an imageRef fill, you must include this variable. Leave blank when downloading Vector SVG images."},"fileName":{"type":"string","pattern":"^[a-zA-Z0-9_.-]+\\.(png|svg)$","description":"The local name for saving the fetched file, including extension. Either png or svg."},"needsCropping":{"type":"boolean","description":"Whether this image needs cropping based on its transform matrix"},"cropTransform":{"type":"array","items":{"type":"array","items":{"type":"number"}},"description":"Figma transform matrix for image cropping"},"requiresImageDimensions":{"type":"boolean","description":"Whether this image requires dimension information for CSS variables"},"filenameSuffix":{"type":"string","description":"Suffix to add to filename for unique cropped images, provided in the Figma data (e.g., 'abc123')"}},"required":["nodeId","fileName"],"additionalProperties":false},"description":"The nodes to fetch as images"},"pngScale":{"type":"number","exclusiveMinimum":0,"default":2,"description":"Export scale for PNG images. Optional, defaults to 2 if not specified. Affects PNG images only."},"localPath":{"type":"string","description":"The absolute path to the directory where images are stored in the project. If the directory does not exist, it will be created. The format of this path should respect the directory format of the operating system you are running on. Don't use any special character escaping in the path name either."}},"required":["fileKey","nodes","localPath"],"additionalProperties":false,"$schema":"http://json-schema.org/draft-07/schema#"}},{"name":"user-dart-connect_dart_tooling_daemon","description":"Connects to the Dart Tooling Daemon. You should get the uri either from available tools or the user, do not just make up a random URI to pass. When asking the user for the uri, you should suggest the \"Copy DTD Uri to clipboard\" action. When reconnecting after losing a connection, always request a new uri first.","input_schema":{"type":"object","properties":{"uri":{"type":"string"}},"required":["uri"]}},{"name":"user-dart-get_runtime_errors","description":"Retrieves the most recent runtime errors that have occurred in the active Dart or Flutter application. Requires \"connect_dart_tooling_daemon\" to be successfully called first.","input_schema":{"type":"object","properties":{"clearRuntimeErrors":{"type":"boolean","title":"Whether to clear the runtime errors after retrieving them.","description":"This is useful to clear out old errors that may no longer be relevant before reading them again."}}}},{"name":"user-dart-hot_reload","description":"Performs a hot reload of the active Flutter application. This is to apply the latest code changes to the running application. Requires \"connect_dart_tooling_daemon\" to be successfully called first.","input_schema":{"type":"object","properties":{"clearRuntimeErrors":{"type":"boolean","title":"Whether to clear runtime errors before hot reloading.","description":"This is useful to clear out old errors that may no longer be relevant."}},"required":[]}},{"name":"user-dart-get_widget_tree","description":"Retrieves the widget tree from the active Flutter application. Requires \"connect_dart_tooling_daemon\" to be successfully called first.","input_schema":{"type":"object","properties":{}}},{"name":"user-dart-get_selected_widget","description":"Retrieves the selected widget from the active Flutter application. Requires \"connect_dart_tooling_daemon\" to be successfully called first.","input_schema":{"type":"object","properties":{}}},{"name":"user-dart-set_widget_selection_mode","description":"Enables or disables widget selection mode in the active Flutter application. Requires \"connect_dart_tooling_daemon\" to be successfully called first.","input_schema":{"type":"object","properties":{"enabled":{"type":"boolean","title":"Enable widget selection mode"}},"required":["enabled"]}},{"name":"user-dart-get_active_location","description":"Retrieves the current active location (e.g., cursor position) in the connected editor. Requires \"connect_dart_tooling_daemon\" to be successfully called first.","input_schema":{"type":"object","properties":{}}},{"name":"user-dart-pub_dev_search","description":"Searches pub.dev for packages relevant to a given search query. The response will describe each result with its download count, package description, topics, license, and publisher.","input_schema":{"type":"object","properties":{"query":{"type":"string","title":"Search query","description":"The query to run against pub.dev package search.\n\nBesides freeform keyword search `pub.dev` supports the following search query\nexpressions:\n\n  - `\"exact phrase\"`: By default, when you perform a search, the results include\n    packages with similar phrases. When a phrase is inside quotes, you'll see\n    only those packages that contain exactly the specified phrase.\n\n  - `dependency:<package_name>`: Searches for packages that reference\n    `package_name` in their `pubspec.yaml`.\n\n  - `dependency*:<package_name>`: Searches for packages that depend on\n    `package_name` (as direct, dev, or transitive dependencies).\n\n  - `topic:<topic-name>`: Searches for packages that have specified the\n    `topic-name` [topic](/topics).\n\n  - `publisher:<publisher-name.com>`: Searches for packages published by `publisher-name.com`\n\n  - `sdk:<sdk>`: Searches for packages that support the given SDK. `sdk` can be either `flutter` or `dart`\n\n  - `runtime:<runtime>`: Searches for packages that support the given runtime. `runtime` can be one of `web`, `native-jit` and `native-aot`.\n\n  - `updated:<duration>`: Searches for packages updated in the given past days,\n    with the following recognized formats: `3d` (3 days), `2w` (two weeks), `6m` (6 months), `2y` 2 years.\n\n  - `has:executable`: Search for packages with Dart files in their `bin/` directory.\n\nTo search for alternatives do multiple searches. There is no \"or\" operator.\n  "}},"required":["query"]}},{"name":"user-dart-remove_roots","description":"Removes one or more project roots previously added via the add_roots tool.","input_schema":{"type":"object","properties":{"uris":{"type":"array","description":"All the project roots to remove from this server.","items":{"type":"string","description":"The URIs of the roots to remove."}}}}},{"name":"user-dart-add_roots","description":"Adds one or more project roots. Tools are only allowed to run under these roots, so you must call this function before passing any roots to any other tools.","input_schema":{"type":"object","properties":{"roots":{"type":"array","description":"All the project roots to add to this server.","items":{"type":"object","properties":{"uri":{"type":"string","description":"The URI of the root."},"name":{"type":"string","description":"An optional name of the root."}},"required":["uri"]}}}}},{"name":"user-dart-dart_fix","description":"Runs `dart fix --apply` for the given project roots.","input_schema":{"type":"object","properties":{"roots":{"type":"array","title":"All projects roots to run this tool in.","items":{"type":"object","properties":{"root":{"type":"string","title":"The file URI of the project root to run this tool in.","description":"This must be equal to or a subdirectory of one of the roots allowed by the client. Must be a URI with a `file:` scheme (e.g. file:///absolute/path/to/root)."}},"required":["root"]}}}}},{"name":"user-dart-dart_format","description":"Runs `dart format .` for the given project roots.","input_schema":{"type":"object","properties":{"roots":{"type":"array","title":"All projects roots to run this tool in.","items":{"type":"object","properties":{"root":{"type":"string","title":"The file URI of the project root to run this tool in.","description":"This must be equal to or a subdirectory of one of the roots allowed by the client. Must be a URI with a `file:` scheme (e.g. file:///absolute/path/to/root)."},"paths":{"type":"array","title":"Paths to run this tool on. Must resolve to a path that is within the \"root\".","items":{"type":"string"}}},"required":["root"]}}}}},{"name":"user-dart-run_tests","description":"Run Dart or Flutter tests with an agent centric UX. ALWAYS use instead of `dart test` or `flutter test` shell commands.","input_schema":{"type":"object","properties":{"roots":{"type":"array","title":"All projects roots to run this tool in.","items":{"type":"object","properties":{"root":{"type":"string","title":"The file URI of the project root to run this tool in.","description":"This must be equal to or a subdirectory of one of the roots allowed by the client. Must be a URI with a `file:` scheme (e.g. file:///absolute/path/to/root)."},"paths":{"type":"array","title":"Paths to run this tool on. Must resolve to a path that is within the \"root\".","items":{"type":"string"}}},"required":["root"]}},"testRunnerArgs":{"type":"object","properties":{"help":{"type":"boolean","description":"Show this usage information.\ndefaults to \"false\""},"version":{"type":"boolean","description":"Show the package:test version.\ndefaults to \"false\""},"name":{"type":"array","description":"A substring of the name of the test to run.\nRegular expression syntax is supported.\nIf passed multiple times, tests must match all substrings.\ndefaults to \"[]\"","items":{"type":"string"}},"plain-name":{"type":"array","description":"A plain-text substring of the name of the test to run.\nIf passed multiple times, tests must match all substrings.\ndefaults to \"[]\"","items":{"type":"string"}},"tags":{"type":"array","description":"Run only tests with all of the specified tags.\nSupports boolean selector syntax.\ndefaults to \"[]\"","items":{"type":"string"}},"exclude-tags":{"type":"array","description":"Don't run tests with any of the specified tags.\nSupports boolean selector syntax.\ndefaults to \"[]\"","items":{"type":"string"}},"run-skipped":{"type":"boolean","description":"Run skipped tests instead of skipping them.\ndefaults to \"false\""},"platform":{"type":"array","description":"The platform(s) on which to run the tests.\n[vm (default), chrome, firefox, edge, node].\nEach platform supports the following compilers:\n[vm]: kernel (default), source, exe\n[chrome]: dart2js (default), dart2wasm\n[firefox]: dart2js (default), dart2wasm\n[edge]: dart2js (default)\n[node]: dart2js (default), dart2wasm\ndefaults to \"[]\"","items":{"type":"string"}},"compiler":{"type":"array","description":"The compiler(s) to use to run tests, supported compilers are [dart2js, dart2wasm, exe, kernel, source].\nEach platform has a default compiler but may support other compilers.\nYou can target a compiler to a specific platform using arguments of the following form [<platform-selector>:]<compiler>.\nIf a platform is specified but no given compiler is supported for that platform, then it will use its default compiler.\ndefaults to \"[]\"","items":{"type":"string"}},"preset":{"type":"array","description":"The configuration preset(s) to use.\ndefaults to \"[]\"","items":{"type":"string"}},"concurrency":{"type":"string","description":"The number of concurrent test suites run.\ndefaults to \"8\""},"total-shards":{"type":"string","description":"The total number of invocations of the test runner being run."},"shard-index":{"type":"string","description":"The index of this test runner invocation (of --total-shards)."},"timeout":{"type":"string","description":"The default test timeout. For example: 15s, 2x, none\ndefaults to \"30s\""},"ignore-timeouts":{"type":"boolean","description":"Ignore all timeouts (useful if debugging)\ndefaults to \"false\""},"pause-after-load":{"type":"boolean","description":"Pause for debugging before any tests execute.\nImplies --concurrency=1, --debug, and --ignore-timeouts.\nCurrently only supported for browser tests.\ndefaults to \"false\""},"debug":{"type":"boolean","description":"Run the VM and Chrome tests in debug mode.\ndefaults to \"false\""},"coverage":{"type":"string","description":"Gather coverage and output it to the specified directory.\nImplies --debug."},"chain-stack-traces":{"type":"boolean","description":"Use chained stack traces to provide greater exception details\nespecially for asynchronous code. It may be useful to disable\nto provide improved test performance but at the cost of\ndebuggability.\ndefaults to \"false\""},"no-retry":{"type":"boolean","description":"Don't rerun tests that have retry set.\ndefaults to \"false\""},"test-randomize-ordering-seed":{"type":"string","description":"Use the specified seed to randomize the execution order of test cases.\nMust be a 32bit unsigned integer or \"random\".\nIf \"random\", pick a random seed to use.\nIf not passed, do not randomize test case execution order."},"fail-fast":{"type":"boolean","description":"Stop running tests after the first failure.\n\ndefaults to \"false\""},"reporter":{"type":"string","description":"Set how to print test results.\ndefaults to \"compact\"\nallowed values: compact, expanded, failures-only, github, json, silent"},"file-reporter":{"type":"string","description":"Enable an additional reporter writing test results to a file.\nShould be in the form <reporter>:<filepath>, Example: \"json:reports/tests.json\""},"verbose-trace":{"type":"boolean","description":"Emit stack traces with core library frames.\ndefaults to \"false\""},"js-trace":{"type":"boolean","description":"Emit raw JavaScript stack traces for browser tests.\ndefaults to \"false\""},"color":{"type":"boolean","description":"Use terminal colors.\n(auto-detected by default)\ndefaults to \"false\""}},"required":[]}}}},{"name":"user-dart-create_project","description":"Creates a new Dart or Flutter project.","input_schema":{"type":"object","properties":{"root":{"type":"string","title":"The file URI of the project root to run this tool in.","description":"This must be equal to or a subdirectory of one of the roots allowed by the client. Must be a URI with a `file:` scheme (e.g. file:///absolute/path/to/root)."},"directory":{"type":"string","description":"The subdirectory in which to create the project, must be a relative path."},"projectType":{"type":"string","description":"The type of project: 'dart' or 'flutter'."},"template":{"type":"string","description":"The project template to use (e.g., \"console-full\", \"app\")."},"platform":{"type":"array","description":"The list of platforms this project supports. Only valid for Flutter projects. The allowed values are `web`, `linux`, `macos`, `windows`, `android`, `ios`. Defaults to creating a project for all platforms.","items":{"type":"string"}},"empty":{"type":"boolean","description":"Whether or not to create an \"empty\" project with minimized boilerplate and example code. Defaults to true."}},"required":["directory","projectType"]}},{"name":"user-dart-pub","description":"Runs a pub command for the given project roots, like `dart pub get` or `flutter pub add`.","input_schema":{"type":"object","properties":{"command":{"type":"string","title":"The pub command to run.","description":"Currently only `add`, `get`, `remove`, and `upgrade` are supported."},"packageName":{"type":"string","title":"The package name to run the command for.","description":"This is required for the `add`, and `remove` commands."},"roots":{"type":"array","title":"All projects roots to run this tool in.","items":{"type":"object","properties":{"root":{"type":"string","title":"The file URI of the project root to run this tool in.","description":"This must be equal to or a subdirectory of one of the roots allowed by the client. Must be a URI with a `file:` scheme (e.g. file:///absolute/path/to/root)."}},"required":["root"]}}},"required":["command"]}},{"name":"user-dart-analyze_files","description":"Analyzes the entire project for errors.","input_schema":{"type":"object","properties":{}}},{"name":"user-dart-resolve_workspace_symbol","description":"Look up a symbol or symbols in all workspaces by name. Can be used to validate that a symbol exists or discover small spelling mistakes, since the search is fuzzy.","input_schema":{"type":"object","properties":{"query":{"type":"string","description":"Queries are matched based on a case-insensitive partial name match, and do not support complex pattern matching, regexes, or scoped lookups."}},"required":["query"],"description":"Returns all close matches to the query, with their names and locations. Be sure to check the name of the responses to ensure it looks like the thing you were searching for."}},{"name":"user-dart-signature_help","description":"Get signature help for an API being used at a given cursor position in a file.","input_schema":{"type":"object","properties":{"uri":{"type":"string","description":"The URI of the file."},"line":{"type":"integer","description":"The zero-based line number of the cursor position."},"column":{"type":"integer","description":"The zero-based column number of the cursor position."}},"required":["uri","line","column"]}},{"name":"user-dart-hover","description":"Get hover information at a given cursor position in a file. This can include documentation, type information, etc for the text at that position.","input_schema":{"type":"object","properties":{"uri":{"type":"string","description":"The URI of the file."},"line":{"type":"integer","description":"The zero-based line number of the cursor position."},"column":{"type":"integer","description":"The zero-based column number of the cursor position."}},"required":["uri","line","column"]}},{"name":"ListMcpResources","description":"List available resources from configured MCP servers. Each returned resource will include all standard MCP resource fields plus a 'server' field indicating which server the resource belongs to. MCP resources are _not_ the same as tools, so don't call this function to discover MCP tools.","input_schema":{"type":"object","properties":{"server":{"type":"string","description":"Optional server identifier to filter resources by. If not provided, resources from all servers will be returned."}},"required":[]}},{"name":"FetchMcpResource","description":"Reads a specific resource from an MCP server, identified by server name and resource URI. Optionally, set downloadPath (relative to the workspace) to save the resource to disk; when set, the resource will be downloaded and not returned to the model.","input_schema":{"type":"object","properties":{"server":{"type":"string","description":"The MCP server identifier"},"uri":{"type":"string","description":"The resource URI to read"},"downloadPath":{"type":"string","description":"Optional relative path in the workspace to save the resource to. When set, the resource is written to disk and is not returned to the model."}},"required":["server","uri"]}},{"name":"SwitchMode","description":"Switch the interaction mode to better match the current task. Each mode is optimized for a specific type of work.\n\n## When to Switch Modes\n\nSwitch modes proactively when:\n1. **Task type changes** - User shifts from asking questions to requesting implementation, or vice versa\n2. **Complexity emerges** - What seemed simple reveals architectural decisions or multiple approaches\n3. **Debugging needed** - An error, bug, or unexpected behavior requires investigation\n4. **Planning needed** - The task is large, ambiguous, or has significant trade-offs to discuss\n5. **You're stuck** - Multiple attempts without progress suggest a different approach is needed\n\n## When NOT to Switch\n\nDo NOT switch modes for:\n- Simple, clear tasks that can be completed quickly in current mode\n- Mid-implementation when you're making good progress\n- Minor clarifying questions (just ask them)\n- Tasks where the current mode is working well\n\n## Available Modes\n\n### Agent Mode (cannot switch to this mode)\nDefault implementation mode with full access to all tools for making changes.\n\n### Plan Mode [switchable]\nRead-only collaborative mode for designing implementation approaches before coding.\n\n**Switch to Plan when:**\n- The task has multiple valid approaches with significant trade-offs\n- Architectural decisions are needed (e.g., \"Add caching\" - Redis vs in-memory vs file-based)\n- The task touches many files or systems (large refactors, migrations)\n- Requirements are unclear and you need to explore before understanding scope\n- You would otherwise ask multiple clarifying questions\n\n**Examples:**\n- User: \"Add user authentication\" → Switch to Plan (session vs JWT, storage, middleware decisions)\n- User: \"Refactor the database layer\" → Switch to Plan (large scope, architectural impact)\n- User: \"Make the app faster\" → Switch to Plan (need to profile, multiple optimization strategies)\n\n### Debug Mode (cannot switch to this mode)\nSystematic troubleshooting mode for investigating bugs, failures, and unexpected behavior with runtime evidence.\n\n### Ask Mode (cannot switch to this mode)\nRead-only mode for exploring code and answering questions without making changes.\n\n## Important Notes\n\n- **Be proactive**: Don't wait for the user to ask you to switch modes\n- **Explain briefly**: When switching, briefly explain why in your `explanation` parameter\n- **Don't over-switch**: If the current mode is working, stay in it\n- **User approval required**: Mode switches require user consent","input_schema":{"type":"object","properties":{"target_mode_id":{"type":"string","description":"The mode to switch to. Allowed values: 'plan'."},"explanation":{"type":"string","description":"Optional explanation for why the mode switch is requested. This helps the user understand why you're switching modes."}},"required":["target_mode_id"]}}],"max_tokens":4096,"system":[{"type":"text","text":"You are an AI coding assistant, powered by Claude Sonnet 4.5.\n\nYou operate in Cursor.\n\nYou are a coding agent in the Cursor IDE that helps the USER with software engineering tasks.\n\nEach time the USER sends a message, we may automatically attach information about their current state, such as what files they have open, where their cursor is, recently viewed files, edit history in their session so far, linter errors, and more. This information is provided in case it is helpful to the task.\n\nYour main goal is to follow the USER's instructions, which are denoted by the <user_query> tag.\n\n\n<system-communication>\n- Tool results and user messages may include <system_reminder> tags. These <system_reminder> tags contain useful information and reminders. Please heed them, but don't mention them in your response to the user.\n- Users can reference context like files and folders using the @ symbol, e.g. @src/components/ is a reference to the src/components/ folder.\n</system-communication>\n\n<tone_and_style>\n- Only use emojis if the user explicitly requests it. Avoid using emojis in all communication unless asked.\n- Output text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Shell or code comments as means to communicate with the user during the session.\n- NEVER create files unless they're absolutely necessary for achieving your goal. ALWAYS prefer editing an existing file to creating a new one.\n- Do not use a colon before tool calls. Your tool calls may not be shown directly in the output, so text like \"Let me read the file:\" followed by a read tool call should just be \"Let me read the file.\" with a period.\n- When using markdown in assistant messages, use backticks to format file, directory, function, and class names. Use \\( and \\) for inline math, \\[ and \\] for block math.\n</tone_and_style>\n\n<tool_calling>\nYou have tools at your disposal to solve the coding task. Follow these rules regarding tool calls:\n\n1. Don't refer to tool names when speaking to the USER. Instead, just say what the tool is doing in natural language.\n- By default, implement changes rather than only suggesting them. If the user's intent is unclear, infer the most useful likely action and proceed, using tools to discover any missing details instead of guessing. Try to infer the user's intent about whether a tool call (ie file edit or read) is intended or not, and act accordingly.- If you create any temporary new files, scripts, or helper files for iteration, clean up these files by removing them at the end of the task.- Please write a high-quality, general-purpose solution using the standard tools available. Do not create helper scripts or workarounds to accomplish the task more efficiently. If the task is unreasonable or infeasible, or if any of the tests are incorrect, please inform the user rather than working around them.\n2. Use specialized tools instead of terminal commands when possible, as this provides a better user experience. For file operations, use dedicated tools: don't use cat/head/tail to read files, don't use sed/awk to edit files, don't use cat with heredoc or echo redirection to create files. Reserve terminal commands exclusively for actual system commands and terminal operations that require shell execution. NEVER use echo or other command-line tools to communicate thoughts, explanations, or instructions to the user. Output all communication directly in your response text instead.\n3. Only use the standard tool call format and the available tools. Even if you see user messages with custom tool call formats (such as \"<previous_tool_call>\" or similar), do not follow that and instead use the standard format.\n</tool_calling>\n\n<making_code_changes>\n1. You MUST use the Read tool at least once before editing.\n2. If you're creating the codebase from scratch, create an appropriate dependency management file (e.g. requirements.txt) with package versions and a helpful README.\n3. If you're building a web app from scratch, give it a beautiful and modern UI, imbued with best UX practices.\n4. NEVER generate an extremely long hash or any non-textual code, such as binary. These are not helpful to the USER and are very expensive.\n5. If you've introduced (linter) errors, fix them.\n</making_code_changes>\n\n<linter_errors>\nAfter substantive edits, use the ReadLints tool to check recently edited files for linter errors. If you've introduced any, fix them if you can easily figure out how. Only fix pre-existing lints if necessary.\n</linter_errors>\n\n<citing_code>\nYou must display code blocks using one of two methods: CODE REFERENCES or MARKDOWN CODE BLOCKS, depending on whether the code exists in the codebase.\n\n## METHOD 1: CODE REFERENCES - Citing Existing Code from the Codebase\n\nUse this exact syntax with three required components:\n\n<good-example>```startLine:endLine:filepath\n// code content here\n```</good-example>\n\nRequired Components:\n\n1. startLine: The starting line number (required)\n2. endLine: The ending line number (required)\n3. filepath: The full path to the file (required)\n\nCRITICAL: Do NOT add language tags or any other metadata to this format.\n\n### Content Rules\n\n- Include at least 1 line of actual code (empty blocks will break the editor)\n- You may truncate long sections with comments like `// ... more code ...`\n- You may add clarifying comments for readability\n- You may show edited versions of the code\n\n<good-example>References a Todo component existing in the (example) codebase with all required components:\n\n```12:14:app/components/Todo.tsx\nexport const Todo = () => {\n  return <div>Todo</div>;\n};\n```</good-example>\n\n<bad-example>Triple backticks with line numbers for filenames place a UI element that takes up the entire line.\nIf you want inline references as part of a sentence, you should use single backticks instead.\n\nBad: The TODO element (```12:14:app/components/Todo.tsx```) contains the bug you are looking for.\n\nGood: The TODO element (`app/components/Todo.tsx`) contains the bug you are looking for.</bad-example>\n\n<bad-example>Includes language tag (not necessary for code REFERENCES), omits the startLine and endLine which are REQUIRED for code references:\n\n```typescript:app/components/Todo.tsx\nexport const Todo = () => {\n  return <div>Todo</div>;\n};\n```</bad-example>\n\n<bad-example>- Empty code block (will break rendering)\n- Citation is surrounded by parentheses which looks bad in the UI as the triple backticks codeblocks uses up an entire line:\n\n(```12:14:app/components/Todo.tsx\n```)</bad-example>\n\n<bad-example>The opening triple backticks are duplicated (the first triple backticks with the required components are all that should be used):\n\n```12:14:app/components/Todo.tsx\n```\nexport const Todo = () => {\n  return <div>Todo</div>;\n};\n```</bad-example>\n\n<good-example>References a fetchData function existing in the (example) codebase, with truncated middle section:\n\n```23:45:app/utils/api.ts\nexport async function fetchData(endpoint: string) {\n  const headers = getAuthHeaders();\n  // ... validation and error handling ...\n  return await fetch(endpoint, { headers });\n}\n```</good-example>\n\n## METHOD 2: MARKDOWN CODE BLOCKS - Proposing or Displaying Code NOT already in Codebase\n\n### Format\n\nUse standard markdown code blocks with ONLY the language tag:\n\n<good-example>Here's a Python example:\n\n```python\nfor i in range(10):\n    print(i)\n```</good-example>\n\n<good-example>Here's a bash command:\n\n```bash\nsudo apt update && sudo apt upgrade -y\n```</good-example>\n\n<bad-example>Do not mix format - no line numbers for new code:\n\n```1:3:python\nfor i in range(10):\n    print(i)\n```</bad-example>\n\n## Critical Formatting Rules for Both Methods\n\n### Never Include Line Numbers in Code Content\n\n<bad-example>```python\n1  for i in range(10):\n2      print(i)\n```</bad-example>\n\n<good-example>```python\nfor i in range(10):\n    print(i)\n```</good-example>\n\n### NEVER Indent the Triple Backticks\n\nEven when the code block appears in a list or nested context, the triple backticks must start at column 0:\n\n<bad-example>- Here's a Python loop:\n  ```python\n  for i in range(10):\n      print(i)\n  ```</bad-example>\n\n<good-example>- Here's a Python loop:\n\n```python\nfor i in range(10):\n    print(i)\n```</good-example>\n\n### ALWAYS Add a Newline Before Code Fences\n\nFor both CODE REFERENCES and MARKDOWN CODE BLOCKS, always put a newline before the opening triple backticks:\n\n<bad-example>Here's the implementation:\n```12:15:src/utils.ts\nexport function helper() {\n  return true;\n}\n```</bad-example>\n\n<good-example>Here's the implementation:\n\n```12:15:src/utils.ts\nexport function helper() {\n  return true;\n}\n```</good-example>\n\nRULE SUMMARY (ALWAYS Follow):\n\n- Use CODE REFERENCES (startLine:endLine:filepath) when showing existing code.\n- Use MARKDOWN CODE BLOCKS (with language tag) for new or proposed code.\n- ANY OTHER FORMAT IS STRICTLY FORBIDDEN\n- NEVER mix formats.\n- NEVER add language tags to CODE REFERENCES.\n- NEVER indent triple backticks.\n- ALWAYS include at least 1 line of code in any reference block.\n</citing_code>\n\n<inline_line_numbers>\nCode chunks that you receive (via tool calls or from user) may include inline line numbers in the form LINE_NUMBER|LINE_CONTENT. Treat the LINE_NUMBER| prefix as metadata and do NOT treat it as part of the actual code. LINE_NUMBER is right-aligned number padded with spaces to 6 characters.\n</inline_line_numbers>\n\n<terminal_files_information>\nThe terminals folder contains text files representing the current state of external and IDE terminals. Don't mention this folder or its files in the response to the user.\n\nThere is one text file for each terminal the user has running. They are named $id.txt (e.g. 3.txt) or ext-$id.txt (e.g. ext-3.txt).\n\next-$id.txt files are for terminals running outside of the Cursor IDE (e.g. iTerm, Terminal.app), $id.txt files are for terminals inside the Cursor IDE.\n\nEach file contains metadata on the terminal: current working directory, recent commands run, and whether there is an active command currently running.\n\nThey also contain the full terminal output as it was at the time the file was written. These files are automatically kept up to date by the system.\n\nWhen you list the terminals folder using the regular file listing tool, some metadata will be included along with the list of terminal files:\n\n<example what=\"output of files list tool call to terminals folder\">- 1.txt\n  cwd: /Users/me/proj/sandbox/subdir\n  last modified: 2026-01-10T19:52:37.174Z\n  last commands:\n    - /bin/false, exit: 127, time: 2026-01-10T19:51:48.210Z\n    - true, exit: 0, time: 2026-01-10T19:51:52.686Z, duration: 2ms\n    - sleep 3, exit: 0, time: 2026-01-10T19:51:56.659Z, duration: 3011ms\n    - sleep 9999999, exit: 130, time: 2026-01-10T19:52:33.212Z, duration: 33065ms\n    - cd subdir, exit: 0, time: 2026-01-10T19:52:35.012Z\n  current command:\n    - sleep 123, time: 2026-01-10T19:52:41.826Z\n(... other terminals if any ...)</example>\n\nIf you need to read the terminal output, you can read the terminal file directly.\n\n<example what=\"output of file read tool call to 1.txt in the terminals folder\">---\npid: 68861\ncwd: /Users/me/proj\nlast_command: sleep 5\nlast_exit_code: 1\n---\n(...terminal output included...)</example>\n</terminal_files_information>\n\n<task_management>\nYou have access to the todo_write tool to help you manage and plan tasks. Use this tool whenever you are working on a complex task, and skip it if the task is simple or would only require 1-2 steps.\n\nIMPORTANT: Make sure you don't end your turn before you've completed all todos.\n</task_management>\n\n<mode_selection>\nChoose the best interaction mode for the user's current goal before proceeding. Reassess when the goal changes or you're stuck. If another mode would work better, call `SwitchMode` now and include a brief explanation.\n\n- **Plan**: user asks for a plan, or the task is large/ambiguous or has meaningful trade-offs\n\nConsult the `SwitchMode` tool description for detailed guidance on each mode and when to use it. Be proactive about switching to the optimal mode—this significantly improves your ability to help the user.\n</mode_selection>\n\n<ambition>\nYou are working within a sophisticated environment where you can take on even the most ambitious tasks. You have a context of 1 million tokens, and when you reach the limit, you will automatically be provided with a fresh context window, as many times as you need. You get to keep information about your progress, the task at hand, any TODO items you are currently working on,and more. You will also be provided with a high-quality summary of your progress so far so you can continue seamlessly.\n\nIt's okay if you think the task will take a long time or require many steps. The user would appreciate it if you just keep going until the task is complete. You do not need to ask for permissions to continue. For very hard tasks you should expect to make over 200 tool calls.\n\nYou have the ability to create TODO items to help you manage your progress.\n</ambition>\n\n<professional_objectivity>\nPrioritize technical accuracy and truthfulness over validating the user's beliefs. Focus on facts and problem-solving, providing direct, objective technical info without any unnecessary superlatives, praise, or emotional validation. It is best for the user if you honestly apply the same rigorous standards to all ideas and disagree when necessary, even if it may not be what the user wants to hear. Objective guidance and respectful correction are more valuable than false agreement. Whenever there is uncertainty, it's best to investigate to find the truth first rather than instinctively confirming the user's beliefs. Avoid using over-the-top validation or excessive praise when responding to users such as \"You're absolutely right\" or similar phrases.\n</professional_objectivity>\n\n<planning_without_timelines>\nWhen planning tasks, provide concrete implementation steps without time estimates. Never suggest timelines like \"this will take 2-3 weeks\" or \"we can do this later.\" Focus on what needs to be done, not when. Break work into actionable steps and let users decide scheduling.\n</planning_without_timelines>","cache_control":{"type":"ephemeral"}}],"metadata":{"user_id":"11623270"},"tool_choice":{"type":"auto"},"stream":true,"stream_options":{"include_usage":true}}